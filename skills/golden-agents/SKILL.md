---
name: golden-agents
description: Use when initializing a new git repo with AI guidance, upgrading existing repos with inadequate AI guidance, or when user says "set up AI guidance" or "add Agents.md" - detects repo state and offers appropriate workflow
---

# Golden Agents

> **Last Updated:** 2026-02-01

## Overview

Initialize or upgrade AI guidance in any repository using the [golden-agents](https://github.com/bordenet/golden-agents) framework. Auto-detects repo state and language, offers appropriate workflow.

**Prerequisite:** Clone golden-agents if not present:

```bash
git clone https://github.com/bordenet/golden-agents.git ~/.golden-agents
```

---

## When to Use

Invoke when:

- Setting up a new repository
- Adding AI guidance to an existing repo
- Upgrading outdated Agents.md files
- User says: "set up AI guidance", "add Agents.md", "upgrade AI guidance"

---

## Phase 1: Detection

### 1.1 Check Prerequisites

```bash
# Verify golden-agents is installed
if [[ ! -f ~/.golden-agents/generate-agents.sh ]]; then
    echo "Installing golden-agents..."
    git clone https://github.com/bordenet/golden-agents.git ~/.golden-agents
fi

# Sync to latest
~/.golden-agents/generate-agents.sh --sync
```

### 1.2 Detect Git State

```bash
# Check if git repo exists
if [[ ! -d .git ]]; then
    echo "No git repository found."
    # Offer: git init
fi
```

### 1.3 Detect Existing AI Guidance

| File State | Action |
|------------|--------|
| No Agents.md | → New generation |
| Agents.md WITH markers | → Upgrade path |
| Agents.md WITHOUT markers | → Migrate path |
| Only CLAUDE.md (no Agents.md) | → Migrate path |

Check for markers:

```bash
if [[ -f Agents.md ]]; then
    if grep -q "<!-- GOLDEN:framework:start -->" Agents.md; then
        echo "Agents.md has markers → Upgrade path"
    else
        echo "Agents.md lacks markers → Migrate path"
    fi
fi
```

### 1.4 Auto-Detect Language and Type

Scan for dependency files:

| File | Language |
|------|----------|
| `go.mod` | go |
| `package.json` | javascript |
| `requirements.txt` / `pyproject.toml` | python |
| `pubspec.yaml` | dart-flutter |
| `Cargo.toml` | rust |
| `*.sh` (multiple) | shell |

Scan for project type indicators:

| Indicator | Type |
|-----------|------|
| `cmd/` directory | cli-tools |
| `templates/` + generator scripts | genesis-tools |
| `src/` + `index.html` or framework config | web-apps |
| `ios/` + `android/` directories | mobile-apps |

**Present findings to user for confirmation:**

```
Detected:
  Languages: go, shell
  Type: cli-tools

Proceed with these settings? [Y/n/edit]
```

---

## Phase 2: Execute Workflow

### 2.1 New Repository (No .git)

```bash
# Initialize git
git init
git branch -M main

# Generate AI guidance
~/.golden-agents/generate-agents.sh \
    --language=DETECTED_LANGS \
    --type=DETECTED_TYPE \
    --path=.

# Create redirect files (see Phase 3)

# Initial commit
git add Agents.md CLAUDE.md CODEX.md GEMINI.md COPILOT.md
git commit -m "feat: Initialize repository with AI guidance

Generated by golden-agents v1.2.0
Languages: DETECTED_LANGS
Type: DETECTED_TYPE"
```

### 2.2 New AI Guidance (Git exists, no Agents.md)

```bash
# Generate AI guidance
~/.golden-agents/generate-agents.sh \
    --language=DETECTED_LANGS \
    --type=DETECTED_TYPE \
    --path=.

# Create redirect files (see Phase 3)

# Commit
git add Agents.md CLAUDE.md CODEX.md GEMINI.md COPILOT.md
git commit -m "feat: Add AI guidance files

Generated by golden-agents v1.2.0"
```

### 2.3 Upgrade (Agents.md with markers)

```bash
# Preview changes first
~/.golden-agents/generate-agents.sh --upgrade --path=.

# If user approves, apply
~/.golden-agents/generate-agents.sh --upgrade --apply --path=.

# Commit
git add Agents.md
git commit -m "chore: Upgrade AI guidance framework

golden-agents v1.2.0
Project-specific content preserved."
```

### 2.4 Migrate (Agents.md without markers OR only CLAUDE.md)

**Interactive choice required:**

```
Existing AI guidance found but lacks framework markers.

Options:
  [M] Migrate - Extract custom rules, generate new file, merge
  [R] Replace - Back up old file, generate fresh (manually re-add custom rules)
  [C] Cancel

Choice:
```

**Migrate workflow:**

1. Extract project-specific content from existing file
2. Generate new Agents.md with markers
3. Append extracted content to "Project-Specific Rules" section
4. User reviews merged result

```bash
# Back up existing
cp Agents.md Agents.md.backup 2>/dev/null || cp CLAUDE.md CLAUDE.md.backup

# Extract custom content (everything after standard sections)
# This requires manual review - show user what was found

# Generate new
~/.golden-agents/generate-agents.sh \
    --language=DETECTED_LANGS \
    --type=DETECTED_TYPE \
    --path=.

# User manually merges custom content into Project-Specific Rules section
echo "Review Agents.md and add your custom rules to the Project-Specific Rules section"
echo "Backup saved as: Agents.md.backup"
```

**Replace workflow:**

```bash
# Back up existing
mv Agents.md Agents.md.backup 2>/dev/null
mv CLAUDE.md CLAUDE.md.backup 2>/dev/null

# Generate fresh
~/.golden-agents/generate-agents.sh \
    --language=DETECTED_LANGS \
    --type=DETECTED_TYPE \
    --path=.

echo "Fresh Agents.md generated. Review backup to re-add custom rules."
```

---

## Phase 3: Create Redirect Files

After generating Agents.md, create redirects for all AI assistants:

```bash
# CLAUDE.md
cat > CLAUDE.md << 'EOF'
# Claude Instructions

See **[Agents.md](./Agents.md)** for all AI guidance.
EOF

# CODEX.md
cat > CODEX.md << 'EOF'
# OpenAI Codex CLI Instructions

See **[Agents.md](./Agents.md)** for all AI guidance.
EOF

# GEMINI.md
cat > GEMINI.md << 'EOF'
# Gemini Instructions

See **[Agents.md](./Agents.md)** for all AI guidance.
EOF

# COPILOT.md
cat > COPILOT.md << 'EOF'
# GitHub Copilot Instructions

See **[Agents.md](./Agents.md)** for all AI guidance.
EOF
```

---

## Phase 4: Commit

**Always ask before committing.** Suggest message based on action:

| Action | Commit Message |
|--------|----------------|
| New repo | `feat: Initialize repository with AI guidance` |
| Add to existing | `feat: Add AI guidance files` |
| Upgrade | `chore: Upgrade AI guidance framework` |
| Migrate | `refactor: Migrate to golden-agents framework` |

---

## Quick Reference

| Command | Purpose |
|---------|---------|
| `~/.golden-agents/generate-agents.sh --help` | Show all options |
| `~/.golden-agents/generate-agents.sh --sync` | Update templates from GitHub |
| `~/.golden-agents/generate-agents.sh --dry-run` | Preview without writing |
| `~/.golden-agents/generate-agents.sh --upgrade` | Preview upgrade diff |
| `~/.golden-agents/generate-agents.sh --upgrade --apply` | Apply upgrade |
| `~/.golden-agents/generate-agents.sh --compact` | Generate ~130 line version |

---

## Language Detection Script

```bash
detect_languages() {
    local langs=""
    [[ -f go.mod ]] && langs="${langs}go,"
    [[ -f package.json ]] && langs="${langs}javascript,"
    [[ -f requirements.txt || -f pyproject.toml ]] && langs="${langs}python,"
    [[ -f pubspec.yaml ]] && langs="${langs}dart-flutter,"
    [[ -f Cargo.toml ]] && langs="${langs}rust,"
    [[ $(find . -maxdepth 2 -name "*.sh" | wc -l) -gt 2 ]] && langs="${langs}shell,"
    echo "${langs%,}"  # Remove trailing comma
}

detect_type() {
    [[ -d cmd ]] && echo "cli-tools" && return
    [[ -d templates && -f generate*.sh ]] && echo "genesis-tools" && return
    [[ -d ios && -d android ]] && echo "mobile-apps" && return
    [[ -f index.html || -f vite.config.* || -f next.config.* ]] && echo "web-apps" && return
    echo "cli-tools"  # Default
}
```

---

## Common Mistakes

| Mistake | Fix |
|---------|-----|
| Running without `--path` | Always specify `--path=.` or target directory |
| Upgrading file without markers | Use migrate workflow instead |
| Forgetting redirect files | Always create all 4 (CLAUDE, CODEX, GEMINI, COPILOT) |
| Not syncing before upgrade | Run `--sync` to get latest templates |

---

## Related Skills

- **readme-authoring**: After setting up AI guidance, update README
- **superpowers:verification-before-completion**: Verify files before committing


